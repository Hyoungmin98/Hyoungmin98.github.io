---
layout: post
title:  "Review: 'Characteristics are covariances: A unified model of risk and return'"
date:   2025-11-03 22:38:28 +0900
math: true
categories: Review
tags: Quant  
---

**해당 게시글은 Kelly et al.,(2019)의 "Characteristics are covariances: A unified model of risk and return" 논문을 리뷰한 글입니다.**   

사실 원래는 Brian Kelly의 "Autoencoder Asset Pricing Models" 논문을 리뷰해보려 했으나, Introduction을 읽어보니 이 논문에서 파생되어 만들어진 논문이라는 느낌이 들기도 했고, IPCA를 먼저 이해하는 것이 중요할 것 같아 해당 논문을 먼저 리뷰해보기로 했다.  

# 1. Introduction  
그동안의 다양한 자산들이 서로 다른 기대수익률을 기록하는 이유에 대한 설명으로는 균형이론(equilibrium theory)가 가장 대표적이라 할 수 있다.   
이는 기대수익률의 차이가 각기 다른 위험에 대한 보상을 반영한다는 가정을 가지는데, 즉 "위험이 큰 만큼 보상이 커진다."라는 주장이다.  

그러나 많은 실증연구에서는 이러한 논리가 작용되지 않는 경우가 많이 생기는데, 가장 대표적으로 Fama-French 3 factor models가 있다. 이는 가치요인(Value factor), 규모요인(Size Factor)와 같이 위험 대비 보상 측면에서 볼 수 없는 현상들이 존재함을 보였다.  

자산가격결정이론의 출발점은 오일러 방정식으로부터 시작했는데  
$E_t[m_{t+1}r_{i,t+1}] = 0$  
여기서 m은 확률적 할인요인을 의미한다. 즉 무차익 조건에서 어떤 위험자산도 기대수익이 0이어야 한다는 식인데, 이를 기반으로 팩터모델이 파생되었다.  

$r_{i,t+1} = \alpha_{i,t} + \beta'_{i,t}f_{t+1} + \epsilon_{i,t+1}$  
- 회귀계수이자 팩터 로딩 베타는 체계적 위험 요인에 대한 익스포져를 의미.  
- 알파는 팩터 프리미엄(f)로 설명되지 않는 초과 수익률을 의미.  

그러나 위 팩터 모델을 분석하기 위해서는 팩터 프리미엄(f), 팩터 익스포져(beta)를 관측할 수 있어야 하는데, 이때 가장 일반적인 방법(Fama and French(1993))으로 팩터 프리미엄을 요인 값으로 정렬된 자산군들을 기반으로 롱-숏 포트폴리오를 만들어 사용하는 방법이 있다. 다만 이 방법의 단점은 사전 이해가 필요한 만큼 부분적인 이해가 될 수 있다는 점이다.  
두번째 방법으로는 Chamberlain and Rothschild(1983), Connor and Korajczyk(1986)가 제시한 것으로, 팩터를 사전에 지정하지 않고 PCA를 활용해서 잠재 요인(latet factor)를 추출하는 것이다. 이 방법의 경우에는 정적 로딩만 허용하는 PCA 모델의 단점이 존재하며, 수익률 이외에 다른 데이터를 활용하는데에 어려움이 있다는 것도 단점이 될 수 있다.  
  



## 1.1 Our methodology  
본 논문에서는 팩터와 로딩값을 추정하기 위해 사용하는 위의 두 방법 대신 IPCA(Instrumented principal components analysis)를 사용한다. 이는 사전에 정확한 요인을 선정해야 한다는 전제가 필요하다는 단점을 커버할 수 있다. 또한 특성값을 도구변수로 활용하여 경제적인 해석이 가능하도록 한다는 장점도 존재한다.  

또한 IPCA는 기존 PCA의 장점을 그대로 살린다. 높은 상관성, 잡음을 포함한 데이터에서도 저차원 요인 구조를 강제함으로써 자산 수익 패턴을 가장 잘 설명하는 핵심 특성만을 추출해낸다.  

IPCA를 통해 만든 팩터 모델에서 특성-기대수익률 관계가 latent factor의 리스크 노출로 인한 보상으로 결정된다면 latent factor와 베타(팩터 로딩)를 추정한다. 반면 이러한 팩터가 존재하지 않을 경우에는 특성 효과는 절편에 귀속된다. 또한 이를 알파 기반 검정을 통해 특성 기반 수익률 현상이 팩터 모델로 설명 가능한 위험에 대한 보상인지, 아니면 단순 이상현상인지 구분할 수 있다.  



## 1.2 Findings   
본 논문의 모델 평가 기준은 다음과 같다.  
- 성공적인 팩터 모델은 체계적 위험을 정확하게 설명할 수 있어야 한다(모델이 추정한 베타 및 팩터 프리미엄이 모든 자산&시간에 잘 적용되는가?).  
    - total $R^2$ 측정을 통해 분석  
- 성공적인 팩터 모델은 자산 간 기대수익률의 차이를 정확하게 설명할 수 있어야 한다(자산별로 모델이 각 시점에 대해 예측한 기대수익률 VS 자산별로 실제 각 시점의 수익률).  
    - Predictive $R^2$ 측정을 통해 분석   

→ ***이부분을 이해하는데 시간을 많이 소요했다. 결국 모델이 공통 리스크 요인을 적절하게 찾았는가?와 자산의 기대수익률을 모델이 정확히 예측하는가? 이렇게 두가지를 평가했다는 것으로 이해했다. 아래는 챗지피티가 표로 깔끔하게 요약한 것.***  
![image1.png](/assets/images/IPCA_factor_model/image1.png)    


활용 데이터는 1962~2014년 까지 12,000개 이상의 주식 수익률 및 특성 데이터를 사용한다.  

결과적으로, IPCA 기반 팩터 모델이 Fama-French 5 factor model과 PCA 기반 팩터 모델보다 더 높은 predictive $R^2$ 값을 가진다. In-sample 의 경우 total $R^2$ 는 18.6%로 가장 낮긴 하지만(다른 모델은 각각 21.9%, 31.5%) In-sample 및 Out-of-Sample predictive $R^2$ 값은 가장 높았다.  

- IPCA가 모델 자체에서 가지는 장점은 무엇인가?  
1. 5팩터 모델의 경우 자산이 12000개면 기존 팩터 모델들은 대략 60000개의 파라미터를 추정해야 하는 반면, IPCA는 약 3000개만 추정하면 된다는 장점이 있다.  
2. 기존 팩터 모델들은 팩터 익스포져를 시간에 따라 변화시켜주어야 하기 때문에 롤링 윈도우 형태로 계속해서 학습을 시켜야 한다. 하지만 IPCA는 특성값이 변동하면 그대로 팩터 익스포져도 변동하기 때문에 자산마다 재추정을 할 필요가 없고, 롤링 윈도우 설정에 대한 고민을 하지 않아도 된다는 장점이 존재한다.  

그러나 IPCA 기반 팩터모델의 한계점으로는, 자산 간 평균 수익률의 차이가 특성값(z)의 차이로 인해 발생하면서도, 팩터 익스포져로는 설명되지 않는 부분이 있을 수도 있다는 점에 대한 의문점을 해결하지 못했다.   
즉, 특성 → 베타(팩터 익스포져) → 수익률 관계가 아닌 특성 → 수익률 같은 직접적인 관계가 있을 수도 있다는 점은 여전히 의문으로 남아있다.  

IPCA 기반 팩터 모델의 경우 알파(절편)을 0으로 설정한 경우와 아닌 경우를 각각 수행하였으며, 이때 싱글팩터 모델의 경우 알파를 포함하는 것이 모델의 설명력을 증가시켰다. 이후 팩터를 계속해서 늘려본 결과, 다섯개의 latent factor가 가장 높은 설명력과 팩터 익스포져로 설명되지 않는 이상현상이 존재하지 않는다는 것을 보였다.  
또한 IPCA 기반 팩터 모델에서의 접점 포트폴리오(Tangency Portfolio)가 기존 파마프랜치 5팩터모델 보다 높은 샤프비율을 기록함으로써 효율적 경계션에 더 가까이 위치함을 알 수 있다.  

마지막으로 IPCA를 통해 36개의 기업 특성값 중 10개가 1% 수준에서 통계적으로 유의함을 발견하였으며, 이 특성들만을 활용하여 모델을 추정해도 기존에 모든 특성을 사용한 모델과 거의 동일했음을 확인했다.  

# 2. Model and estimation  
IPCA 모델은 다음과 같다.  
![image1.png](/assets/images/IPCA_factor_model/image2.png)    
- T기간 동안 N개의 자산으로 구성된다.  
- $\gamma_{\beta}$ 는 모든 자산 및 모든 시점에 대해 일관되게 적용되는 값으로, 이 값을 학습함으로써 베타를 동적으로 변화시킬 수 있다.   
- 특성으로 설명되지 않는 요인들은 $v_{\beta,i,t}$ 로 처리된다.  
- 이때 수익률 데이터만을 활용하여 팩터 익스포져를 추정하는 PCA와는 다르게 특성 벡터 z를 통해 팩터 구조를 추정할 수 있다는 장점이 있다.  
- 이렇게 팩터 익스포져(beta)와 팩터 프리미엄(f)를 동시에 추정해낸다. 따라서 시계열 팩터 모델이자 횡단면 팩터 모델
IPCA는 기존 전통적인 팩터 모델과 같이 모델의 alpha 값을 "이상현상(anomaly)"라고 부르지만, 이러한 현상이 여러 자산의 수익률 간 공분산을 만들어낸다면 그것을 리스크 팩터로 해석한다.  

(https://chatgpt.com/s/t_69147441e94481919f5482d4c774534e) → 모델의 학습, 추정 과정을 GPT가 깔끔하게 설명해줌. 이해에 도움이 될듯.  


## 2.1. Restricted model ($\Gamma_{α} = 0$)  
먼저 알파값이 0인, 즉 모델의 특성이 anomaly를 나타낼 가능성을 배제한 IPCA 모델을 사용한다.  

$r_{i,t+1} = z_{i,t}'\Gamma_{\beta} f_{t+1} + \epsilon_{i,t+1}$   

→ r: 수익률, z: 특성, $\epsilon$ : 개별 종목 잔차  

![image1.png](/assets/images/IPCA_factor_model/image3.png)    
→ SSE를 최소화하도록 교대 추정을 통해 f와 $\Gamma$ 를 각각 추정한다.  

이때 f를 추정하는 과정은 횡단면 회귀로 이루어진다. 즉, 각 시점에서 자산 개수 N만큼을 샘플로 하여 $f_{1}, ... ,f_{t+1}$을 추정해낸다.  
그 다음, 추정된 f를 토대로 패널 데이터를 모두 사용하여 $\Gamma$ 를 재추정한다.  
→ 계속 반복  

이 과정에서 회전 불확실성으로 인해 팩터의 방향이 식별되지 않기 때문에 제약식을 몇개 제약조건을 걸어서 회전 자유도를 제거한다. → 팩터를 유일하게 만들 수 있음.  

1. $\beta'\beta = I$  → 로딩 방향, 길이 고정  
2. $Cov(f) = diag$ → 팩터 순서 고정  
3. $mean(f) \geq 0$ → 팩터 부호 고정  

### 2.1.1. A managed portfolio interpretation of IPCA  
$\beta$ 가 정적일 경우 IPCA = PCA 이다. 그러나 $\beta$ 가 dynamic할 경우 훨씬 더 복잡한 최적화 문제를 풀어냄으로써 $\Gamma$ 값을 추정한다.  

![image1.png](/assets/images/IPCA_factor_model/image4.png)    

이때 $\beta$ 의 초깃값은 어떻게 구하는가?  
→ returns를 특성 기반으로 변환한 후 변환된 패널에 SVD(특이값 분해) 적용.  
이를 통해 PCA와 유사한 방식으로 초깃값을 설정한다.  

이러한 베타 초깃값을 설정해주기 위해 특성값들을 기반으로 특성 포트폴리오를 만든다.  
$x_{t+1} = \frac{Z'_{t}r_{t+1}}{N_{t+1}}$  
이때 Z'Z가 변동성이 작다면 X'X에 PCA를 적용한 결과와 IPCA의 최적해와 거의 동일하게 된다. 이는 매우 복잡한 IPCA 최적화 과정의 수렴성을 높이는데 큰 도움을 준다.   


또한 지금까지 많은 asset pricing 문헌들은 어떤 자산들을 활용하여 모델을 평가할지에 대한 어려움을 겪어왔다. 
→ IPCA는 개별 주식들을 사용하지만 이를 기반으로 특성 포트폴리오를 만들기 때문에 각각의 장점을 모두 흡수할 수 있음. 또한 결측치가 존재하는 일부 종목들의 경우 제외하고 특성값과 수익률 값이 모두 존재하는 종목들만 활용하므로 Missing Data 문제까지 해결이 가능.  
특히 PCA의 경우 자산 수익률이 조금이라도 결측이 생길 경우 행렬 계산 자체가 깨지는 반면 IPCA는 특성의 차원(L)으로 작동하기 때문에 훨씬 더 안정적이다.  

→ **아니 그러면 IPCA도 특성값에 결측치가 있으면 똑같이 행렬 계산이 깨지는거 아닌가?** 라고 생각할 수 있음. 그러나 IPCA는 그런 경우가 발생했을 때 그 시점에서 결측치가 생기는 종목만 제거해주면 됨. 그러나 PCA는 결측치가 발생한 종목은 모든 시점에서 제거해주어야 하기 때문에 훨씬 결측치에 민감하다고 볼 수 있다.  

## 2.2. Unrestricted model ( $\Gamma_{α} \neq 0 )$   
그 다음은 intercept가 존재하는 모델으로, 체계적 위험에 대한 노출로 설명되지 않는 알파가 생길 가능성을 열어둔다.  

$r_{i,t+1} = z_{i,t}'\Gamma_{\alpha} + z_{i,t}'\Gamma_{\beta} f_{t+1} + \epsilon_{i,t+1}$   

![image1.png](/assets/images/IPCA_factor_model/image5.png)   
→ f 추정 과정은 2.1에서와 같이 횡단면 회귀로 이루어지며, 이후 다른 최적화 과정도 유사하게 진행된다.  

그러나 문제는 알파와 베타, f를 동시에 추정하는 과정에서 발생한다.  
평균수익률을 알파로도, 베타로도 설명할 수 있기 때문에 역할이 애매해짐.  
따라서 목적함수 최적화 과정에서 알파와 베타는 직교 관계를 가지도록 하고, 추정된 알파와 베타에 대해 알파를 베타에 회귀시키고 남은 직교 잔차를 알파 값으로 정의한다. 이를 통해 베타가 자산의 기대수익률을 가능한 한 많이 설명할 수 있도록 한다.  

# 3. Asset pricing tests   
이 섹션에서 다루는 가설 검정은 다음과 같다.  
1. IPCA 모델의 제한된 모델과($\Gamma_{\alpha} = 0$) 제한되지 않은 모델($\Gamma_{α} \neq 0$ ) 을 구분하는 Zero-Alpha Test  
2. 관측 가능한 팩터모델(ex. Fama-French 5-factor model)이 IPCA의 latent factor를 통제하면서도 모델 설명력이 유의하게 개선되는지에 대한 검정  
3. 다른 모든 특성을 동시에 통제하면서 개별 특성 또는 집합의 추가적 유의성 검정 → 어떤 특성이 자산 수익률을 설명하는 데 가장 유의한가?  



## 3.1. Testing ($\Gamma_{α} = 0_{L×1}$)  
IPCA 모델에서 특성이 체계적 위험, 즉 latent factor에 대한 노출을 대리하는 경우에는 베타로, 특성이 latent factor와 관련이 없는 anomaly를 발견할 경우에는 알파로 흘러들어간다. 따라서 이 섹션에서는 Unrestricted model에서 도출된 알파값과 0과의 거리를 통해 어떤 모델이(Unrestricted model VS restricted model) 더 적합한지 검정한다.  

$H_0 : \Gamma_\alpha = \mathbf{0}_{L \times 1}$  
→ 특성이 알파를 설명하지 않는다.  

$H_1 : \Gamma_\alpha \neq \mathbf{0}_{L \times 1}$  
→ 특성이 알파를 설명한다.  

이때 각 종목별 알파를 보는 것이 아니라 모든 종목의 모든 알파에 대해 한번에 검정함.  

여기서는 제한 모델과 비제한 모델 간의 알파 거리를 계산하기 위한 Wald-type test 통계량(알파 벡터의 제곱합)으로 구성한다.  
$W_{\alpha} = \hat\Gamma_{\alpha}'\hat\Gamma_{\alpha}$  

먼저 비제한 모델을 추정하고 추정된 매개변수를 유지한다. 이후 부트스트랩을 통해 새롭게 알파들을 다시 추정하고 이렇게 만들어진 알파 분포와 처음 비제한 모델에서 추정한 알파를 비교한다.   
이때 부트스트랩으로 리샘플링되는 변수는 개별 주식 수익률이 아닌 특성 포트폴리오의 잔차이다.  
→ 개별 종목으로 리샘플링 하는 경우 종목 개수 N만큼 리샘플링을 해야하지만 IPCA는 특성 포트폴리오로 변환이 가능하기 때문에 L개만큼만 리샘플링 해주면 됨. 덕분에 계산 비용을 줄일 수 있다.  



### 3.1.1. Comments on bootstrap procedure    
알파, 베타, f를 한꺼번에 추정하기 위해 매우 어려운 고차원 비선형 문제를 해결해야 하는 상황에서 brute-force 최적화를 하면 계산 비용이 너무 커질 수 있기 때문에 특성 포트폴리오로의 변환을 통해 부트스트랩을 특성 포트폴리오의 잔차로 하는 것이 큰 도움이 된다.  

**Brute-force 최적화?**: 문제를 가장 원초적이고 단순한 방식으로 조건을 만족할 때까지 숫자들을 계속 바꿔가며 시도하는 방식의 최적화.  
→ 문제 구조를 단순화하는게 아닌 수치 최적화 알고리즘을 활용하여 그대로 풀어냄.  



## 3.2. Testing observable factor models versus IPCA   
이 섹션에서는 기존의 관측가능한 팩터들을 추가했을 때도 IPCA 모델의 설명력을 평가한다.  

$r_{i,t+1} = \beta_{i,t}f_{t+1} + \delta_{i,t}g_{t+1} + \epsilon_{i,t+1}$  
이때 $\delta_{i,t}g_{t+1}$ 가 새롭게 추가된 것이며, $g_{t+1}$이 관측가능한 팩터들을 의미한다. 그러나 관측가능한 팩터의 로딩은 기존 IPCA 모델에서 latent factor의 로딩을 추정하는 방식과 동일하게 이루어진다.  

이렇게 확장된 IPCA 모델의 설명력을 검정하는 방법은 다음과 같다.  
$H_0: \Gamma_{\delta} = 0_{L\times M}$  
$H_{1}: \Gamma_{\delta} \neq 0_{L\times M}$   

Wald-like test statistic을 구하여 가설을 검정할 수 있으며, $W_{\delta}$ 는 관측가능한 팩터를 추가한 IPCA모델과 기존 IPCA모델 간의 거리를 의미한다.  
(구체적인 계산 과정은 3.1에서 설명한 내용과 유사함.)  


## 3.3. Testing instrument significance   
마지막 검정 섹션으로, 다른 모든 특성을 동시에 통제하면서 개별 특성값의 중요도를 평가한다.  
이때 알파는 0으로 고정하며, 파라미터 행렬을 분할 표현하여 가설을 설정하면 다음과 같다.  

$H_0: \; \Gamma_{\beta} = \begin{bmatrix} \gamma_{\beta,1},\;\ldots,\;\gamma_{\beta,l-1},\;\mathbf{0}_{K \times 1},\;\gamma_{\beta,l+1},\;\ldots,\;\gamma_{\beta,L}\end{bmatrix}^{\prime}$  

$H_1:\;\Gamma_{\beta}=\begin{bmatrix}\gamma_{\beta,1},\;\ldots,\;\gamma_{\beta,L}\end{bmatrix}^{\prime}$  

이 귀무가설 형태는 l번째 특성이 모델에 기여하지 않으려면 K개의 팩터 로딩에 아무런 영향을 미치지 않아야 한다는 사실에서 비롯된다. 따라서 β의 l번째 행 전체가 0이어야 함.  

가설 검정을 위한 부트스트랩 및 통계량 계산은 위 두 과정과 동일하다. 귀무가설(특정 특성이 0)을 적용하여 부트스트랩 과정을 거친 x를 만든 후, 이를 기반으로 만들어진 IPCA모델에서의 $\gamma_{\beta,l}$ 과 대립가설을 적용하여 만들어진 $\gamma_{\beta,l}$ 간의 비교를 통해 검정을 진행한다.   


# 4. Empirical findings   
## 4.1. Data  
Freyberger et al.(2017)에서 주식 수익률 및 특성 데이터를 가져왔으며, 1962년 7월부터 2014년 5월까지로 구성된다. 총 12,813개의 기업을 포함하며, 각 기업에 대해 36가지 특성값을 가지고 있다.

이때 기간별로 각 특성에 대해 주식의 순위를 계산한 후, 관측치 수(누락 X)로 나눠준 후에 -0.5를 적용한다.  
→ 특성값 범위를 [-0.5,0.5]로 매핑.  


## 4.2. The asset pricing performance of IPCA  
모델의 성능을 측정하기 위해서 총 두 가지 $R^2$ 를 사용한다.  

$Total \, R^2 = 1 - \frac{\sum_{i,t}(r_{i,t+1} - z'_{i,t}(\hat\Gamma_{\alpha} + \hat\Gamma_{\beta}\hat f_{t+1}))^2}{\sum_{i,t}r^2_{i,t+1}}$  

Total R²은 주어진 모델에서 체계적 위험이 개별 주식 패널에서 실현된 위험성을 얼마나 잘 설명하는지를 요약하는 지표이다.  

$Predictive \, R^2 = 1 - \frac{\sum_{i,t}(r_{i,t+1} - z'_{i,t}(\hat\Gamma_{\alpha} + \hat\Gamma_{\beta}\hat f_{t+1}))^2}{\sum_{i,t}r^2_{i,t+1}}$  

Predictive R²는 특성이 기대 수익률을 얼마나 잘 설명하는지를 보여주는 지표이다.  

IPCA 모델은 위험 가격(λ)이 시간에 따라 변할 수 있어도 식별이 안되기 때문에 이를 상수로 고정해두고 예측 정보는 오직 β가 어떻게 변하느냐로만 반영된다.  


![image1.png](/assets/images/IPCA_factor_model/image6.png)   
위 표는 alpha 제한 모델 및 비제한 모델에 대해 latent factor 수 K = 1,2,3,4,5,6 으로 각각 설정하여 Total R² 과 Predictive R² 를 제시한 표이다.  
- 결과적으로 single factor model의 경우 각각 14.8%, 15.2%를 기록하며 CAPM의 Total R²인 11.9보다 더 높은 설명력을 가지는 것을 알 수 있다.  
- 대체적으로 팩터 수를 늘릴수록 Total R² 및 Predictive R²가 높아진다. 예외적으로, 개별 주식 차원에서 비제한 모델의 Predictive R²가 K=1에서 가장 설명력이 높게 나왔는데(0.76), 이는 개별 주식 차원에서 생기는 노이즈가 모델의 오버피팅을 만들어냈음을 유추해볼 수 있다.  
    - 이때 제한 모델이 비제한 모델의 약 절반만큼의 설명력을 가지는 것을 보아 제한된 single factor IPCA 모델이 조건부 기대 수익률의 이질성을 설명하지 못함을 나타낸다고 할 수 있다(P-value 또한 1% 미만으로 귀무가설 기각).
- IPCA 모델에서 특성이 예측한 내용을 알파 또는 베타로 귀속시킬 수 있기 때문에 일반적으로 비제한 모델이 제한 모델보다 더 높은 설명력을 보인다.  

추가적으로 Fama and French(1993)처럼 팩터의 설명력을 포트폴리오 관점에서 보는 경우가 일반적이기 때문에, IPCA에서는 특성 기반 포트폴리오 x에 대한 설명력을 추가로 제공한다.  


![image1.png](/assets/images/IPCA_factor_model/image7.png)   
- 위 표는 CAPM 및 PCA 기반 팩터 모델, 관측가능한 팩터를 추가한 IPCA 모델의 Total R² 과 Predictive R²을 비교한 표이다.  
- IPCA는 최소자승법을 사용하여 추정되기 때문에 기대수익률을 설명하는 것보단 체계적 위험을 설명하도록 최적화된다. 위 표의 PCA 기반 팩터모델에서도 알 수 있듯이 Total R²이 높게 나와도 Pred.R² 이 매우 낮은 값을 보일 수 있다는 것. 하지만 IPCA는 Pred.R² 도 준수하게 나옴으로써 기대수익률을 비교적 정확하게 예측한다는 것을 보였다.  


## 4.3. Comparison with existing models  
![image1.png](/assets/images/IPCA_factor_model/image7.png)   
이 섹션에서는 기존의 관측 가능한 팩터를 가지는 모델들을 비교한다.  
K = 1 → CAPM  
K = 3 → Fama French 3 factor models  
K = 4 → Carhart 4 factor models  
K = 5 → Fama French 5 factor models  
K = 6 → Fama French 5 factor models + MOM(모멘텀)  

- 관측 가능한 팩터 모델은 일반적으로 동일한 수의 팩터를 사용하는 IPCA보다 Total R²가 약간 더 높게 나타난다.  
- 반면, IPCA는 관측 가능한 팩터 모델보다 Pred.R² 가 더 높게 나타나는 것을 알 수 있다.  
- 특성 포트폴리오 x에서는, 3 이상의 K에서 관측 가능한 팩터모델의 경우 설명력의 개선이 더이상 없는 반면 IPCA의 경우 점진적으로 설명력이 높아진다.  


![image1.png](/assets/images/IPCA_factor_model/image8.png)   
위 표에서는 관측 가능한 팩터들이 포함된 IPCA 모델의 설명력을 확인한다.  
- K = 1 에서, 관측 가능한 팩터들을 추가하면 IPCA 모델의 설명력이 증가하는 것을 볼 수 있다.  
- 가설 검정 결과 RMW와 MOM 팩터가 K = 1 에서 IPCA 모델보다 통계적으로 유의미한 개선을 제공하며, MOM의 경우 K=4 까지 유의미한 설명력의 개선을 보여준다.  
- K가 증가할수록 관측 가능한 팩터들의 중요도는 줄어든다. K가 5 이상일 경우에는 IPCA 모델에서 관측 가능한 팩터로 인한 추가 설명력이 미미해진다.  


### 4.3.1. Other observable factors  
여기서는 IPCA를 Fama-French 팩터모델과는 다른 팩터들을 사용하는 관측 가능한 팩터모델과 비교한다.  
1. Hou et al.,(HXZ, 2015) → 4 factor models.  
    - Market, Size, Investment, Momentum  
2. Stambaugh and Yuan (SY, 2017) → 4 factor models.  
    - Market, Size, Mispricing(2)  
3. Barillas and Shanken (BS,2018) → 6 factor models.  
    - 이전에 연구된 많은 요인들 가운데 통계적으로 선택된 6개의 팩터  

HXZ & BS의 팩터는 1967-2014년 동안 이용 가능하며, SY의 팩터는 1963-2016년 동안 이용 가능.  

![image1.png](/assets/images/IPCA_factor_model/image9.png)   
- 3개의 팩터모델 모두 체계적 위험에 대한 좋은 설명력을 보이며, 대체적으로 14~23%에 위치한다.  
- 3개의 팩터모델 모두 IPCA에 약 절반밖에 되지 않지만, 특성을 사용한 팩터모델(패널B)은 Pred.R²이 전반적으로 향상된다.  
- IPCA모델에 해당 팩터들을 추가하면 Total R²이 약 2%씩 증가하며, K=5 IPCA 모델에 추가할 경우 설명력이 더욱 개선된다.  

## 4.4. Out-of-sample fits   
이 섹션에서는 IPCA모델의 OOS 성과를 평가한다.  
이때 t가 120 이상일 경우부터는 t시점까지의 모든 데이터를 사용하여 모델을 추정한다.  

 ![image1.png](/assets/images/IPCA_factor_model/image10.png)   
위 표는 Out-of-Sample R²를 나타내는 표이다.  
- 결과적으로 IPCA의 성과가 In-sample 뿐만 아니라 Out-of-Sample에서도 우수한 성과를 보인다.  
- 이는 단순히 통계적으로 Overfitting 된 모델이 아니라는 것을 나타낸다.  

## 4.5. Unconditional mean-variance efficiency  
IPCA 모델 실험 과정에서 알파 값이 0에 가까운 유의미하지 않은 값이 도출되엇기 때문에 이는 평균-분산 효율성을 달성한다.  
또한 IPCA는 자산의 팩터 로딩이 특성에 따라 변화하기 때문에 조건부 자산가격결정모형에 가깝다고 할 수 있다.  
이는 투자자가 본인이 가진 정보를 바탕으로 의사결정을 진행한다는 관점에서 실용성이 더 높다고 할 수 있다.  
그러나 동적 모형의 추정과 투자자의 조건부 정보를 가정해야 한다는 점에서 계량경제학 측면의 까다로움이 존재한다.   
→ 이러한 이유로 많은 문헌들이 비조건부 추정 및 검정에 집중.  

따라서 IPCA 모델을 기존의 비조건부 모델과 직접적으로 비교하기 어렵고, 이러한 간극을 메우기 위해 IPCA 모델의 비조건부 효율성을 평가한다.  

### 4.5.1. Does IPCA “price” anomalies unconditionally?   
IPCA에서 구한 latent factor와 관측 가능한 팩터들이 이상현상 포트폴리오를 책정해낼 수 있는지 여부를 조사한다.  
이를 위해 각 팩터에 대해 포트폴리오 수익률을 회귀분석하여 알파를 추정한다.  
- 사용되는 이상현상 포트폴리오는 37개의 특성 기반 포트폴리오 $x_t$  
- 포트폴리오의 연간 샤프 비율의 평균과 중앙값은 각각 0.52와 0.45.  

![image1.png](/assets/images/IPCA_factor_model/image11.png)    
위 그림은 각 팩터모델 별로 알파 추정치를 45도 선과 함께 나타낸 그림이다.  
이때 t-통계량이 2.0을 초과하는 알파는 채워진 사각형으로 표시된다.  
- FFC6 모델에서 29개의 특성 포트폴리오가 알파를 얻음. 이들은 대부분 통계적으로 유의했으며 45도 선을 중심으로 클러스터링 되어있기 때문에 평균 수익률이 관측 가능한 팩터들로 설명되지 않는다는 것을 나타낸다.  
- IPCA5(Uncond.) 의 경우 IPCA 모델을 추정한 후 이를 토대로 전체 샘플 시계열 회귀(정적 베타)를 수행하여 무조건부 알파를 구한다. 그 결과 7개만이 통계적으로 유의한 알파가 나타났다.  
- IPCA5(Cond.) 의 경우 4개의 포트폴리오가 통계적으로 유의한 알파를 나타냈지만 비교적으로 작은 값으로 나왔다.  
→ IPCA 팩터가 조건부 다변량 평균-분산 효율성에 근접할 뿐만 아니라 무조건적으로도 효율적임을 뒷받침하는 결론을 제공한다.   

### 4.5.2. Factor tangency portfolios   
여기서는 무조건부 IPCA 팩터 에 대한 OOS 샤프비율을 비교한다. 팩터 집합의 Tangency Portfolio의 수익률 또한 추정된 팩터의 평균과 공분산 행렬을 통해 OOS 기준으로 구성된다.  
![image1.png](/assets/images/IPCA_factor_model/image12.png)    
- 패널 A는 IPCA 모델의 팩터를, 패널 B에는 기존의 관측 가능한 팩터를 나타낸다.  
- Univariate는 각 팩터 하나씩만 사용한 포트폴리오, Tangency는 K개 팩터에 대한 최적 조합 포트폴리오(샤프비율 최대화 포트폴리오).  
- Tangency Portfolio의 경우 t시점까지의 f를 이용해 최적화를 수행한 후 도출된 weight를 t+1시점의 f에 적용.  
- K=1 의 경우, CPAM의 마켓 팩터(0.46)보다 더 높은 샤프비율(0.62)을 기록했다.   
- K를 추가할수록 샤프비율이 점점 더 높아지며, K=6 의 경우 IPCA 팩터는 4.05라는 매우 큰 샤프비율 값을 가진다.  
- 본 연구에서는 거래비용과 같은 요소들을 고려하지 않았기 때문에 실제 투자전략으로써 활용성이 높음을 주장한다고 볼 수는 없다.  
→ IPCA 팩터의 평균-분산 효율성을 설명하는데에 집중함.  

### 4.5.3. IPCA “arbitrage”portfolios   
![image1.png](/assets/images/IPCA_factor_model/image13.png)    
위 표는 알파를 0으로 제한하지 않은 IPCA 모델에서의 알파 포트폴리오 샤프비율이다.  
- 순수 알파 포트폴리오의 샤프비율은 0.55~1.07 범위를 가지며. 4.5.2의 표에서의 IPCA 팩터 포트폴리오보다 매우 낮은 것을 확인할 수 있다.  


## 4.6. Interpreting IPCA factors   
$\beta$ 행렬의 k번째 열은 각 특성이 k번째 팩터에 대해 어떻게 매핑되었는지를 확인할 수 있게 한다.  
→ 추정된 IPCA 팩터의 특성을 이해하는데 도움이 될 수 있음.  


![image1.png](/assets/images/IPCA_factor_model/image14.png)   
- Factor 1의 경우, 시가총액과 장부 자산이라는 두가지 특성에 의해 결정된다. 이 특성들은 Factor 1의 베타에 유사한 크기와 반대 부호로 들어가기 때문에 다른 조건이 동일하다면 장부자산이 시가총액에 비해 큰 기업이 Factor 1에 대한 베타가 더 크다.  
- 또한 Factor 1에서 기대수익률이 양수이기 때문에 장부자산 대비 시가총액이 높은 주식이 높은 기대수익률을 가진다고 볼 수 있다.  
→ Value Factor(HML) 와 비슷한 의미를 가짐. 다만 BM을 그대로 사용하는 HML 팩터와 달리 Factor 1은 book assets과 market cap을 분리된 특성값으로 넣어서 추정. 실제로 정작 BM 특성은 거의 0에 가까움.   
- Factor 2의 경우, Constant 및 시장 베타에 의해 결정된다. 즉 모든 기업이 Constatnt를 통해 공통적인 위험을 공유하며, 이 팩터 또한 기대우식률이 양수였기 때문에 시장 베타가 더 높을수록 기대수익률이 더 높아진다.  
→ 실제로 Factor 2는 CRSP value-weighted index 포트폴리오와 85%의 상관관계를 가짐.  
- Factor 3과 4는 각각 12개월 주식 모멘텀과 1개월 주식 리버절 현상에 의해
→ Factor 3은 UMD 팩터와 50% 상관관계를 가지며, Factor 4는 ST Rev 팩터와 31% 상관관계를 가짐.  
- Factor 5의 경우에는 여러 특성의 혼합으로 이루어져 있음.  

## 4.7. Large versus small stocks   
대형주와 소형주의 수익률은 공분산, 유동성, 기대수익률 측면에서 서로 다른 형태를 보이는 경향이 있다.  
일반적으로 변동성은 소형주>대형주이기 때문에, 이 섹션에서는 IPCA 모델의 높은 설명력이 대형주가 아닌 소형주 위주로 설명하기 때문에 발생한 것인지에 대한 의문을 제시한다.  
![image1.png](/assets/images/IPCA_factor_model/image15.png)   
위 표는 소형주와 대형주 각각의 상황에서 IPCA 모델의 설명력을 비교한 표이다.  
- 전체 샘플로 먼저 IPCA 모델을 학습시켜 파라미터를 추정한 후, 각각의 하위 샘플에서 R² 재계산.  
- 매월 시가총액이 가장 높은 1000개의 주식을 "Large", 나머지 모든 주식을 "Small"로 분류.   
- 전반적으로 IPCA는 대형주와 소형주 모두 대체로 유사한 결과를 보이며, 오히려 대형주의 변동성을 정확하게 설명함.   


![image1.png](/assets/images/IPCA_factor_model/image16.png)   
위 표는 Out-of-Sample에서 소형주와 대형주 각각의 Tangency Portfolio 샤프비율을 나타낸 표이다.  
- 일반적으로 소형주가 대형주에 비해 Tangency Portfolio의 성과가 좋지만, 대형주의 경우 거래비용이 낮고 유동성이 높기 때문에 실제 투자전략 활용 가능성에도 긍정적임을 보여준다.  

## 4.8. Annual returns   
지금까지는 월별 수익률에 초점을 맞추었으나, 이 섹션에서는 확장 및 강건성 평가를 위해 연간 수익률을 활용하여 IPCA 모델을 다시 분석한다.  

![image1.png](/assets/images/IPCA_factor_model/image17.png)  
- 위 표의 패널 A는 연간 수익률로 제한된(α=0) 모델을 재추정한 In-Sample R²을 나타낸다.  
- 개별 주식에서 K=5일 때, Total R²은 월별 18.6%에서 연간 기준 20.6%로 상승하였으며 Pred.R² 또한 0.7 → 3.0%로 상승하였다.  
- 패널 B는 연간 IPCA 모델의 OOS R²을 나타내며, In-Sample과 유사한 설명력을 보이기에 IPCA 모델이 연간 수익률의 위험과 보상을 여전히 훌륭하게 설명한다는 것을 증명한다.  
→ 기존의 월별 수익률 기준 연구결과가 유동성 부족 or 단기적인 예측 가능한 팩터에 의해 지배되었을 가능성이 낮음을 시사한다.  


## 4.9. Which characteristics matter?   
이 섹션에서는 다른 특성들을 동시에 통제하면서 개별 특성의 통계적 유의성을 테스트한다.    
이 논문에서는 이 기여도를 해당 특성과 관련된 모든 β를 0으로 설정하고 나머지 모델 추정치는 고정했을 때 전체 R²가 얼마나 감소하는지로 정의한다.
![image1.png](/assets/images/IPCA_factor_model/image18.png)  
- 위 표의 결과에 따르면, 36개의 특성 중 1% 수준에서 유의한 특성은 시가총액, 장부 자산, 마켓 베타, 단기 리버절, 모멘텀, 거래량 등 10개에 불과하다. 5% 유의성을 가지는 특성까지 포함해도 총 13개이다.  
- 이는 위의 13개 특성만으로 36개의 특성과 유사한 설명력을 보이는 모델을 만들 수 있을지에 대한 의문을 제기한다.  

![image1.png](/assets/images/IPCA_factor_model/image19.png)  
위 표는 1% 수준에서 유의했던 10개의 특성만을 사용하여 IPCA 모델의 설명력을 나타낸 표이다.  
- 10개 특성으로 만든 IPCA 모델이 36개 특성을 모두 사용한 모델과 매우 유사한 성능을 보였다.  

![image1.png](/assets/images/IPCA_factor_model/image20.png)  
위 표는 동일한 특성 테스트를 통해 선택된 특성 집합의 안정성을 평가한다.  
먼저 제한된 IPCA, K=5 에서 대형주와 소형주를 각각 재추정하고 각 하위 샘플에서 특성의 유의성을 평가한다.  
- 5% 수준에서 13개의 유의미한 특성 중 6개에 대해 일치하며, 시가총액, 자산, 베타, 12-2 모멘텀, 52주 최고가 대비 가격, 장기 리버절이 포함된다.  
- 단기 리버절, 거래량, 설명되지 않은 거래량의 경우 기준 및 소형주 샘플에서는 매우 유의미한 반면 대형주에서는 유의하지 않은 것으로 나타난다.  
→ 소형주에서 거래 유동성 압력이나 투자자 의견 불일치 현상이 더 강하게 나타남을 반영할 수 있음.  
- 팩터 수를 더 적게 or 많게 해봤을 때, 더 많은 팩터를 허용할 때 더 많은 특성들이 중요해지는 경향을 볼 수 있다.  
- 연간 수익률을 사용한 IPCA의 경우 6가지 특성에서 5% 수준으로 유의함. 이때 단기 리버절, 거래량 등이 유의성을 잃는데 이는 장기 관점에서 거래 압력의 중요성이 감소함을 보여준다. 대신 몇가지 회계 기반 특성이 유의성을 가지게 된다.  


## 4.10. Static or dynamic loadings?  
특성은 횡단면과 종단면 각각에 따라 다른 정보를 가지는데, 이 둘이 IPCA 모델을 서로 다른 방식으로 영향을 주는지 보기 위해 각 특성을 평균과 그 평균을 중심으로 한 편차로 나눈다.  
따라서 이 섹션에서의 L = 2*36 + 1 = 73  

이 섹션에서는 IPCA 모형을 세 가지로 실험하여 비교한다.  
1. 과거 평균 값만을 사용하여 $z = \bar{c}$  
→ "정적 팩터 모형이 수익을 설명하는 데 충분한가?"  
2. 도구변수인 특성값을 편차로 설정하여 $z = c - \bar{c}$  
→ "특성의 시계열 변동이 IPCA 성공의 주요 요인인가?"  
3. 특성이 팩터 로딩 변동의 설명을 횡적, 종적 각각 설명할 수 있도록  $z = (\bar{c}, c - \bar{c})$  

![image1.png](/assets/images/IPCA_factor_model/image21.png)  
위 표는 기존 결과와 더불어 위 3가지 실험을 추가하여 모델의 설명력을 비교한다.  
- Total R²과 Pred.R² 모두에서 기존 실험 및 2번 실험의 결과는 거의 유사하다.  
- 1번 실험의 경우 두 설명력 보두 상당한 감소가 일어난다.  
→ 팩터 노출을 이해하는 데 있어 동적 특성이 가장 중요한 정보임을 시사.  

## 4.11. Split samples  
모델의 강건성을 더 조사하기 위해 이 섹션에서는 두 가지 유형의 50-50 샘플 분할을 수행한다.  
1. 시간적 분할(1996년을 기준으로 샘플의 전반부와 후반부를 구분).  
2. 무작위 분할(무작위로 50% 기업을 선택하여 A그룹, 나머지를 B그룹으로 구분).  
이때 사용되는 모델은 K = 5 IPCA 모델로 Total R²과 Pred.R² 출력.  
이후 한 샘플에서 추정한 파라미터를 사용하여 해당 추정에 기여하지 않은 다른 샘플에 대한 적합 값을 구성하는 교차 검증을 수행.  

![image1.png](/assets/images/IPCA_factor_model/image22.png)  
- 첫 번째 결론은 모든 하위 샘플에서 일어난 모델 적합이 매우 유사하다는 것.  
- 한 그룹에서 추정된 파라미터를 다른 그룹의 R²을 계산하여 교차검증을 수행해도 적합도에 큰 영향을 주지 않음.  


추가적으로 팩터별로 각 샘플에서의 추정 계수를 다른 샘플에서의 추정치와 비교해보았다.  
![image1.png](/assets/images/IPCA_factor_model/image23.png)  
- 1996년 기준 샘플의 경우 파라미터 추정치 간의 상관관계는 52.7% 이며, 45도 선 근처에 위치하고 있다.  
- 무작위 분할 샘플의 경우 파라미터 추정치 간 상관관계가 81.1%로 훨씬 더 강하게 나타났다.  

# 5. Conclusion   
이 논문의 주요 결론은 3가지로 요약할 수 있다.  
1. 사전에 정해진 관측 가능한 팩터에 의존하지 않고 latent factor를 추정함으로써, 주식 수익률의 위험성과 위험 보상을 성공적으로 설명하는 저차원 팩터 모델을 발견.  
2. IPCA 팩터 모델은 작은 가격 오류를 제공하는 데 있어서 Fama-French 5 factor model보다 뛰어남.   
3. IPCA의 실증적인 성공에는 주식 특성 중 일부 소수만이 기여함.  

이 연구를 통해 앞으로의 연구에서는 ‘내가 제안한 특성/수익률 연관성이 특정 사전 정의된 팩터 집합으로 설명되는가?’라는 좁은 질문 대신, '관찰된 특성&수익 패턴을 설명하는 어떤 세트의 팩터가 존재하는가?'라고 질문할 수 있다.  
또한 시간이나 특정 자산에 의존하지 않는 보편적 매개변수 $\beta$ 를 추정함으로써 긴 수익 이력이 없더라도 특성이 알려진 자산이 있다면 예상 수익률을 추정하는데 활용할 수 있다.  



## 리뷰를 마치며  
 이 논문을 리뷰하는데 정말 정말 많은 시간을 썼다. 중간에 읽으면서 다른 논문으로 갈아탈까도 생각이 들었지만...이미 시작한건 끝내자는 마음으로 마무리해보았다.  
논문을 읽으면서 이 IPCA 모델을 처음 제시하고 초깃값 설정, 특성 포트폴리오를 활용, 연구의 강건성을 위해 다양한 시나리오별로 실험하는 것까지 내가 할 수 있는 생각을 아득히 뛰어넘는 아이디어들이 계속해서 나왔다는 점에서 정말 대단함을 느꼈다. 논문을 읽으면서도 정말 감탄만 나왔다. 비판적인 시각에서 논문을 읽으면 개선사항을 볼 수 있을 것이란 배움을 받고 논문을 읽을 때마다 나만의 개선사항을 좀 찾아보려고 하는데, 이 논문은 그럴 용기조차도 안났던, 굉장히 배울점이 많았던 논문이었다. 물론 내가 아직 읽어본 논문이 많지 않고, asset pricing 관련 연구의 흐름을 완벽히 알고 있지 못하기 때문에 내가 감당할 수준이 안되서 그럴 수도 있다.  
그래도 논문을 최대한 이해하려고 노력했다. 하루에 1페이지밖에 못읽는 날도 있을 정도로 깊게 이해하려고 노력했는데 나중에 실력이 더 오르고 다시 읽어보면 보이는게 훨씬 많을 것 같다.  

추가적으로 해당 논문에서 IPCA 모델을 활용한 팩터들은 단순히 평균-분산 효율성에 초점을 두었기 때문에 거래비용 등을 고려하지 않은 비현실적인 팩터 성과라고 말한다. 그러나 샤프비율이 굉장히 높게 나온만큼, 그리고 이 논문에서도 후속 연구로 실질적인 전략 활용성에 대해 언급한 만큼 IPCA 모델의 latent factor가 거래비용을 차감해도 의미가 있는지에 대해서는 확인해보고 싶다는 생각이 들었다.


